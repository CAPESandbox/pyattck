import pytest

@pytest.mark.parametrize(
    'target_attribute', 
    ['enterprise', 'mobile']
)
def test_malware_have_actors(attck_fixture, target_attribute):
    """
    All MITRE ATT&CK Malware should have Actors

    Args:
        attck_fixture ([type]): our default MITRE ATT&CK JSON fixture
    """
    for malware in getattr(attck_fixture, target_attribute).malwares:
        if malware.actors:
            assert getattr(malware,'actors')


@pytest.mark.parametrize(
    'target_attribute', 
    ['enterprise', 'mobile', 'ics']
)
def test_malware_have_techniques(attck_fixture, target_attribute):
    """
    All MITRE ATT&CK Malware should havre techniques

    Args:
        attck_fixture ([type]): our default MITRE ATT&CK JSON fixture
    """
    for malware in getattr(attck_fixture, target_attribute).malwares:
        if malware.techniques:
            assert getattr(malware,'techniques')
